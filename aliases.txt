# useful aliases

# nagios status from status.dat (very kludgey)
alias nagstat "egrep 'host_name|plugin_output|current_state|(host|service)status|service_description' /var/nagios/status.dat | grep -v 'long_plugin_output'"

# cleanup nagios status files that are older than last nagios invocation
# TODO: this should really be done automatically at nagios restart
alias nagclean "find /home/barrycarter/ERR -iname 'nagios.*.err' ! -newer /var/nagios/rw/nagios.cmd | xargs rm"

# check all nagios services
# <h>but mostly show off my insane shell alias</h>
# TODO: make nagios do this at startup somehow?
alias nagcheck "grep host_name /var/nagios/status.dat | sort | uniq | cut -d= -f 2 | xargs -I'{}' echo '['`date +%s`']' 'SCHEDULE_FORCED_HOST_SVC_CHECKS;{};'`date +%s` >> /var/nagios/rw/nagios.cmd"

# start nagios "my way" (sleep sadly needed since nagios doesn't die instantly)
# <h>who needs /etc/init.d anyway!</h>
# this fails if nagios isn't running already; pkill nagios && nagios
# would've been a better option
alias nagstart "echo '['`date +%s`']' RESTART_PROGRAM >> /var/nagios/rw/nagios.cmd; sleep 5; nagclean; nagcheck"





