<!-- 

Attempts to replicate a TCL application I wrote at the dawn of time (1992)
<h>I was dating a girl named Dawn at the time</h>

-->

<body onload="runme();">
<canvas id="zoom" width="800" height="600"></canvas>

<script src="jquery-1.8.0.min.js"></script>
<script type="text/javascript">

// $(document).click(function () {alert("hi there");})
$(document).mousedown(function(e) {
 if (e.shiftKey) {shiftmousedown(e);}
 if (e.ctrlKey) {ctrlmousedown(e);}
})
$(document).mouseup(mouseup)

// pad-specific variables
var pad = [];
pad["zu"] = 10; // "zoom update" how fast to zoom/move on drag/mousedown
pad["zf"] = 1.002 // "zoom factor" how much to zoom on drag/mousedown
var canvas = document.getElementById('zoom');;
var ctx = canvas.getContext('2d');

bindings();

function runme() {
 draw();
}

// zooms around x,y with a zoom factor of z
function zoom(x,y,z) {
 ctx.translate(x,y);
 ctx.scale(z,z);
 ctx.translate(-x,-y);
}

// moves to a given point x,y
function move(x,y) {
 ctx.translate(x,y);
}

// keeps zooming if is_holdzoom is set
function holdzoom(x,y,z) {
 if (is_holdzoom==0) {return;}
 zoom(x,y,z);
 draw();
 setTimeout("holdzoom("+x+","+y+","+z+")", pad["zu"]);
}

// move on mouse drag
function holdmove() {
 // TODO: write this
}

// the bindings (functionalized solely for convenience)
function bindings() {
 // TODO: write this
}


// function to call when mouse is shift-clicked (for now: start zooming)
function shiftmousedown(e) {
 is_holdzoom=1;
 holdzoom(e.pageX,e.pageY,pad["zf"]);
}

// function to call when mouse is ctrl-clicked (for now: start unzooming)
function ctrlmousedown(e) {
 is_holdzoom=1;
 holdzoom(e.pageX,e.pageY,1./pad["zf"]);
}

function mouseup() {is_holdzoom=0;}

// convert pad point coordinates to canvas coordinatese (NOT WORKING)
function ptsc(x,y) {}

function draw(){
 ctx.clearRect(0,0,canvas.width,canvas.height)
 ctx.fillStyle = "rgb(200,0,0)";
 ctx.fillRect (10, 10, 55, 50);
 ctx.fillStyle = "rgba(0, 0, 200, 0.5)";
 ctx.fillRect (30, 30, 55, 50);
}





</script>
