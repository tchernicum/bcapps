<script src="jquery-1.8.0.min.js"></script>

<svg xmlns="http://www.w3.org/2000/svg" version="1.1" id="svg" 
 width="800" height="600" viewbox="0 0 800 600">
 <g id="g">
  <line x1="0" y1="300" x2="800" y2="300" style="stroke:rgb(255,0,0);stroke-width:2">
  <circle cx="100" cy="50" r="40" stroke="black" stroke-width="2" fill="red"/>
 </g>
</svg>

<script language="javascript">

// the SVG file and its graphics content
svg = document.getElementById("svg");
g = document.getElementById("g");

// the initial values
var is_zooming = 0;
var is_moving = 0;
// the initial view is [-1,+1]
var zoom = 1;
var xcenter = 0;
var zoomfactor = 1.001;

// bindings (should these be on the SVG instead of the document?)
$(document).mousedown(
		      function(e) {
			if (e.shiftKey) {shiftmousedown(e);}
			else if (e.ctrlKey) {ctrlmousedown(e);}
			else {mousedown(e);}
		      })
$(document).mouseup(mouseup)

// recenter/scale the document when any change is made
// (doesn't actually redraw, the SVG handles that)
function redraw() {
  var str = "translate(" + xcenter + ",0) scale(" + zoom +",1)";
  g.setAttribute("transform",str);
}

function shiftmousedown() {
 is_zooming = 1;
 holdzoom(zoomfactor);
}

// to be written
function mousedown(e) {
 is_moving = 1;
 holdmove();
}

function ctrlmousedown(e) {
 is_zooming = 1;
 holdzoom(1./zoomfactor);
}

function mouseup(e) {
  is_zooming = 0;
  is_moving = 0;
  redraw();
  alert("X:"+zoom+","+xcenter);
}

// keep zooming by zf
function holdzoom(zf) {
  if (is_zooming) {
    zoom=zoom*zf;
    redraw();
    setTimeout("holdzoom("+zf+")", 10);
  }
}

// keep on movin'
function holdmove() {
 if (is_moving) {
  xcenter++;
  redraw();
  setTimeout("holdmove()", 10);
 }
}

</script>
